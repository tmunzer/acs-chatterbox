doctype html5
html
    head
        title= title
        meta(name="viewport" content="width=device-width, initial-scale=1")

        link(rel="stylesheet" href="/bower_components/material-design-icons/iconfont/material-icons.css")
        link(rel="stylesheet" href="/bower_components/angular-material/angular-material.min.css")
        link(rel="stylesheet" href="/bower_components/angular-material-data-table/dist/md-data-table.min.css")
        link(rel='stylesheet' href='/css/ah-tm.dashboard.css')
        link(rel='stylesheet' href='/css/ah-tm.tags.css')
        link(rel='stylesheet' href='/css/ah-tm.cards.css')
        link(rel='stylesheet' href='/css/ah-tm.md-table.css')
        link(rel='stylesheet' href='/css/ah-tm.md-list.css')
        link(rel='stylesheet' href='/css/ah-tm.label.css')
        link(rel='stylesheet' href='/css/ah-tm.datetime.css')
        
    body(ng-app="chatterbox" ng-controller="AppCtrl").icons-docs
        div(id="loading")
        header.md-page-header
            div.header
            md-toolbar.header.fixed(layout='row')
                h1.logo.md-toolbar-tools
                    if custom && custom.logo && custom.logo.enable
                        img(src=custom.logo.header class="ah-logo")
                    else
                        img(src="/images/logo_w.png" alt="Aerohive")
                span(flex)
                div(style="display:flex; padding-right: 20px")                           
                    md-button(aria-label="logout" href="/logout/" style="margin: auto;")                        
                        md-icon(class="material-icons" aria-label="menu") exit_to_app
                        span Logout

            
        div(id="main")
            md-content.panel(md-whiteframe="7" layout="column")
                md-tabs(md-dynamic-height md-border-bottom)
                    md-tab 
                        md-tab-label Slack
                        md-tab-body
                            md-content(layout-padding)
                                a(href="https://slack.com/oauth/authorize?scope=incoming-webhook,commands&client_id="+slack_client_id)
                                    img(alt="Add to Slack" height="40" width="139" src="https://platform.slack-edge.com/img/add_to_slack.png" srcset="https://platform.slack-edge.com/img/add_to_slack.png 1x, https://platform.slack-edge.com/img/add_to_slack@2x.png 2x")
                            
                            md-content
                                md-table-container
                                    table(md-table md-row-select multiple ng-model="slack_selected" md-progress="slack_request")
                                        thead(md-head md-order="slack_query.order" md-on-reorder="getDesserts")
                                            tr(md-row)
                                                th(md-column md-order-by="team_id")
                                                    span team_id
                                                th(md-column md-order-by="team_name")
                                                    span team_name
                                                th(md-column md-order-by="user_id")
                                                    span user_id
                                                th(md-column md-order-by="scope")
                                                    span scope
                                                th(md-column md-order-by="incoming_webhook.channel")
                                                    span Webhook channel
                                                th(md-column md-order-by="incoming_webhook.channel_id")
                                                    span Webhook channel_id
                                                th(md-column md-order-by="incoming_webhook.configuration_url")
                                                    span Webhook configuration_url
                                                th(md-column md-order-by="incoming_webhook.url")
                                                    span Webhook url
                                                th(md-column md-order-by="access_token")
                                                    span access_token
                                        tbody(md-body)
                                            tr(md-row md-select="slack" md-select-id="slack._id" ng-repeat="slack in slack_data")
                                                td(md-cell) {{slack.team_id}}
                                                td(md-cell) {{slack.team_name}}
                                                td(md-cell) {{slack.user_id}}
                                                td(md-cell) {{slack.scope}}
                                                td(md-cell) {{slack.incoming_webhook.channel}}
                                                td(md-cell) {{slack.incoming_webhook.channel_id}}
                                                td(md-cell) 
                                                    a(ng-href="{{slack.incoming_webhook.configuration_url}}") {{slack.incoming_webhook.configuration_url}}
                                                td(md-cell) 
                                                    a(ng-href="{{slack.incoming_webhook.url}}") {{slack.incoming_webhook.url}}
                                                td(md-cell) {{slack.access_token}}                                                            
                                md-table-pagination(md-limit="slack_query.limit" md-limit-options="[5, 10, 15]" md-page="slack_query.page" md-total="{{slack_data.count}}" md-page-select)
                    md-tab
                        md-tab-label Spark
        
        
        script(type="text/javascript").
            function fadeIn(element){    
                setTimeout(function(){
                    var i = 1;
                    var f = 0.05;
                    element.style.opacity = parseFloat(element.style.opacity) - (f * i * i);
                    i++;
                    if (element.style.opacity > 0 && i < 50) fadeIn(element)
                    else element.parentNode.removeChild(element);;
                    }, 20);
            }
            document.addEventListener("DOMContentLoaded", function(event) {
                var element = document.getElementById("loading"); 
                element.style.opacity = 1.0;                
                fadeIn(element);
            });

        script(src="/bower_components/angular/angular.min.js")

        script(src="/bower_components/angular-aria/angular-aria.js")
        script(src="/bower_components/angular-animate/angular-animate.min.js")
        script(src="/bower_components/angular-material/angular-material.js")
        script(src="/bower_components/angular-messages/angular-messages.js")
        script(src="/bower_components/angular-route/angular-route.min.js")
        script(src="/bower_components/angular-bootstrap/ui-bootstrap.js")
        script(src="/bower_components/angular-material-data-table/dist/md-data-table.min.js")
        script(src="/bower_components/angular-sanitize/angular-sanitize.min.js")
        script(src="/web-app/web-app.js")